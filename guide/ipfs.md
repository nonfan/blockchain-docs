# 基于 IPFS 的去中心化存储

## 什么是 IPFS？

> IPFS（InterPlanetary File System，星际文件系统）是一个点对点（P2P）去中心化文件存储和分发协议，目标是替代
> HTTP，构建一个更安全、更持久的互联网存储网络。

- **HTTP（中心化）** 通过服务器的域名访问文件，依赖于服务器在线。
  如果服务器宕机或删除文件，链接就失效。

- **IPFS（去中心化）** 文件按内容（哈希）存储，全球任何节点都能存储和分发文件，没单点故障。

## IPFS 的核心特点

| 特点   | 解释                    | 好处          |
|------|-----------------------|-------------|
| 内容寻址 | 通过文件内容的哈希值（CID）访问     | 永不冲突，内容不可篡改 |
| 去中心化 | 文件分布在网络中的多个节点         | 抗审查、无单点故障   |
| 持久存储 | 通过 **Pin** 固定内容       | 永久可访问       |
| 版本控制 | 使用 Merkle DAG 数据结构    | 支持版本回溯      |
| 高效传输 | 类似 BT（BitTorrent）分块传输 | 节点间可快速共享    |

## IPFS 的工作原理

**1. 添加文件:** 当你上传一个文件，IPFS 会切成多个数据块，并计算每块的哈希值。

**2. 生成 CID:** 文件被分块、哈希后，会生成一个唯一的 CID（Content Identifier）。

**3. 广播到网络:** 你的 IPFS 节点会把文件及其 CID 广播给连接的其他节点。

**4. 获取文件:** 当别人请求该 CID，IPFS 会从最近的有该内容的节点获取数据。

## 为什么需要 Pin（固定）

IPFS 节点有“垃圾回收机制”，如果没人固定（pin）你的文件，网络上的节点可能会把它删除。

所以大部分 NFT 项目都会用 `Pinata` 或 `Web3.Storage` 来托管文件，确保它一直可用。

普通用户如果只是随便上传一次，不固定，就会发现过几天链接失效了。

**公共 Pin 服务：**

- `Pinata`（功能强大）
- `Web3.Storage`（免费 1TB）

